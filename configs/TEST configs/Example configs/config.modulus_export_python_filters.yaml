# Copied from `configs/TEST configs/Depriciated configs/config.modulus_export_python_filters.yaml` for convenience.
#
# See that file for full comments/intent.

channel_defaults:
  modulus_family: "modulus"

modes:
  modulus_export_raw_only:
    channel_family: "modulus"
    gwyddion_ops:
      - { op: "plane_level" }
      - { op: "align_rows", params: { direction: "horizontal", method: "median" } }
      - { op: "median", params: { size: 3 } }
    stats_source: "python"
    mask: null
    stats_filter:
      exclude_zero: true
      exclude_nonpositive: true
      min_value: 1.0
      max_value: 1000000000.0
      on_empty: "blank"
    python_data_filtering:
      enable: false
      export_raw_csv: true
      export_filtered_csv: false
    metric_type: "modulus"
    units: "kPa"
    expected_units: "kPa"
    on_unit_mismatch: "warn"
    assume_units: "kPa"
    on_missing_units: "warn"

  modulus_export_minmax:
    channel_family: "modulus"
    gwyddion_ops:
      - { op: "plane_level" }
      - { op: "align_rows", params: { direction: "horizontal", method: "median" } }
      - { op: "median", params: { size: 3 } }
    stats_source: "python"
    mask: null
    stats_filter:
      exclude_zero: true
      exclude_nonpositive: true
      min_value: 1.0
      max_value: 1000000000.0
      on_empty: "blank"
    python_data_filtering:
      enable: true
      export_raw_csv: true
      export_filtered_csv: true
      on_empty: "warn"
      filters:
        - { type: "min_max", min_value: 1.0, max_value: 1000000000.0 }
    metric_type: "modulus"
    units: "kPa"
    expected_units: "kPa"
    on_unit_mismatch: "warn"
    assume_units: "kPa"
    on_missing_units: "warn"

  modulus_export_chauvenet:
    channel_family: "modulus"
    gwyddion_ops:
      - { op: "plane_level" }
      - { op: "align_rows", params: { direction: "horizontal", method: "median" } }
      - { op: "median", params: { size: 3 } }
    stats_source: "python"
    mask: null
    stats_filter:
      exclude_zero: true
      exclude_nonpositive: true
      min_value: 1.0
      max_value: 1000000000.0
      on_empty: "blank"
    python_data_filtering:
      enable: true
      export_raw_csv: true
      export_filtered_csv: true
      on_empty: "warn"
      filters:
        - { type: "chauvenet" }
    metric_type: "modulus"
    units: "kPa"
    expected_units: "kPa"
    on_unit_mismatch: "warn"
    assume_units: "kPa"
    on_missing_units: "warn"

  modulus_export_three_sigma:
    channel_family: "modulus"
    gwyddion_ops:
      - { op: "plane_level" }
      - { op: "align_rows", params: { direction: "horizontal", method: "median" } }
      - { op: "median", params: { size: 3 } }
    stats_source: "python"
    mask: null
    stats_filter:
      exclude_zero: true
      exclude_nonpositive: true
      min_value: 1.0
      max_value: 1000000000.0
      on_empty: "blank"
    python_data_filtering:
      enable: true
      export_raw_csv: true
      export_filtered_csv: true
      on_empty: "warn"
      filters:
        - { type: "three_sigma", sigma: 3.0 }
    metric_type: "modulus"
    units: "kPa"
    expected_units: "kPa"
    on_unit_mismatch: "warn"
    assume_units: "kPa"
    on_missing_units: "warn"

  modulus_export_combo:
    channel_family: "modulus"
    gwyddion_ops:
      - { op: "plane_level" }
      - { op: "align_rows", params: { direction: "horizontal", method: "median" } }
      - { op: "median", params: { size: 3 } }
    stats_source: "python"
    mask: null
    stats_filter:
      exclude_zero: true
      exclude_nonpositive: true
      min_value: 1.0
      max_value: 1000000000.0
      on_empty: "blank"
    python_data_filtering:
      enable: true
      export_raw_csv: true
      export_filtered_csv: true
      on_empty: "warn"
      filters:
        - { type: "three_sigma", sigma: 3.0 }
        - { type: "chauvenet" }
        - { type: "min_max", min_value: 1.0, max_value: 1000000000.0 }
    metric_type: "modulus"
    units: "kPa"
    expected_units: "kPa"
    on_unit_mismatch: "warn"
    assume_units: "kPa"
    on_missing_units: "warn"

grid:
  index_base: 1
  filename_regex: "LOC_RC(?P<row>\\d{3})(?P<col>\\d{3})"

summarize:
  recursive: false

debug:
  enable: false
  level: "info"
  artifacts: ["leveled", "aligned", "filtered"]
  sample_limit: 3
  log_fields: ["units", "stats_source", "mixed_processing", "stats_counts", "stats_reasons", "grid", "pyfilter", "pyfilter_steps", "raw_stats"]
  stats_provenance: true

csv_modes:
  default_scalar:
    columns:
      - { name: "source_file", from: "core.source_file" }
      - { name: "mode", from: "core.mode" }
      - { name: "avg_value", from: "core.avg_value" }
      - { name: "std_value", from: "core.std_value" }
      - { name: "units", from: "core.units" }
      - { name: "n_valid", from: "core.n_valid", default: "" }
      - { name: "row_idx", from: "grid.row_idx", default: -1 }
      - { name: "col_idx", from: "grid.col_idx", default: -1 }
    on_missing_field: "warn_null"

result_schemas:
  default_scalar:
    from_csv_mode: "default_scalar"
    fields:
      - { field: "source_file", type: "string", column: "source_file" }
      - { field: "mode", type: "string", column: "mode" }
      - { field: "avg_value", type: "float", column: "avg_value" }
      - { field: "std_value", type: "float", column: "std_value" }
      - { field: "units", type: "string", column: "units" }
      - { field: "n_valid", type: "int", column: "n_valid" }
      - { field: "row_idx", type: "int", column: "row_idx" }
      - { field: "col_idx", type: "int", column: "col_idx" }

plotting_modes:
  sample_bar_with_error:
    recipe: "sample_bar_with_error"
    result_schema: "default_scalar"
    title: "Average with Std"
    label_basename: true
    label_strip_ext: true
    label_max_len: 40
  heatmap_grid_avg_two_panel:
    recipe: "heatmap_two_panel"
    result_schema: "default_scalar"
    left_field: "avg_value"
    right_field: "std_value"
    left_colorbar_label: "avg_value"
    right_colorbar_label: "std_value"

profiles:
  modulus_export_raw_only: { processing_mode: "modulus_export_raw_only", csv_mode: "default_scalar", plotting_modes: ["sample_bar_with_error", "heatmap_grid_avg_two_panel"] }
  modulus_export_minmax: { processing_mode: "modulus_export_minmax", csv_mode: "default_scalar", plotting_modes: ["sample_bar_with_error", "heatmap_grid_avg_two_panel"] }
  modulus_export_chauvenet: { processing_mode: "modulus_export_chauvenet", csv_mode: "default_scalar", plotting_modes: ["sample_bar_with_error", "heatmap_grid_avg_two_panel"] }
  modulus_export_three_sigma: { processing_mode: "modulus_export_three_sigma", csv_mode: "default_scalar", plotting_modes: ["sample_bar_with_error", "heatmap_grid_avg_two_panel"] }
  modulus_export_combo: { processing_mode: "modulus_export_combo", csv_mode: "default_scalar", plotting_modes: ["sample_bar_with_error", "heatmap_grid_avg_two_panel"] }

unit_conversions:
  modulus_export_raw_only:
    kPa: { target: "kPa", factor: 1.0 }
    MPa: { target: "kPa", factor: 1000.0 }
    GPa: { target: "kPa", factor: 1e6 }
    Pa:  { target: "kPa", factor: 0.001 }
  modulus_export_minmax:
    kPa: { target: "kPa", factor: 1.0 }
    MPa: { target: "kPa", factor: 1000.0 }
    GPa: { target: "kPa", factor: 1e6 }
    Pa:  { target: "kPa", factor: 0.001 }
  modulus_export_chauvenet:
    kPa: { target: "kPa", factor: 1.0 }
    MPa: { target: "kPa", factor: 1000.0 }
    GPa: { target: "kPa", factor: 1e6 }
    Pa:  { target: "kPa", factor: 0.001 }
  modulus_export_three_sigma:
    kPa: { target: "kPa", factor: 1.0 }
    MPa: { target: "kPa", factor: 1000.0 }
    GPa: { target: "kPa", factor: 1e6 }
    Pa:  { target: "kPa", factor: 0.001 }
  modulus_export_combo:
    kPa: { target: "kPa", factor: 1.0 }
    MPa: { target: "kPa", factor: 1000.0 }
    GPa: { target: "kPa", factor: 1e6 }
    Pa:  { target: "kPa", factor: 0.001 }
